<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>From ashes to green — Lincoln Park in Chicago’s rebirth</title>
  <meta name="description" content="A cinematic, interactive digital heritage experience of Lincoln Park’s rebirth across the Great Chicago Fire timeline." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0c0f;
      --panel:#0f1117;
      --text:#e9e9ea;
      --muted:rgba(233,233,234,.72);
      --line:rgba(233,233,234,.14);
      --accent:#c9b458;
      --shadow:0 18px 50px rgba(0,0,0,.55);
      --r:18px;
      --r2:26px;
      --max:1180px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 700px at 30% 0%, rgba(255,255,255,.06), transparent 55%),
        radial-gradient(900px 600px at 80% 40%, rgba(201,180,88,.08), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing:.1px;
    }
    a{color:inherit}
    button{font-family:inherit}
    .skip{position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden}
    .skip:focus{left:16px; top:16px; width:auto; height:auto; padding:10px 12px; background:var(--panel); border:1px solid var(--line); border-radius:12px; z-index:9999}

    /* Header */
    header{
      position:sticky; top:0; z-index:30;
      backdrop-filter: blur(10px);
      background: linear-gradient(to bottom, rgba(11,12,15,.92), rgba(11,12,15,.62));
      border-bottom:1px solid var(--line);
      padding:14px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{display:flex; gap:12px; align-items:center; min-width:240px}
    .dot{width:10px; height:10px; border-radius:50%; background:var(--accent); box-shadow:0 0 0 6px rgba(201,180,88,.12)}
    .brand__title{font-weight:600; font-size:13px}
    .brand__sub{font-size:12px; color:var(--muted)}

    nav{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    nav a{
      text-decoration:none; font-size:13px; color:var(--muted);
      padding:10px 10px; border-radius:12px; border:1px solid transparent;
    }
    nav a:hover{color:var(--text); border-color:var(--line); background:rgba(255,255,255,.03)}
    nav a.active{color:var(--text); border-color:rgba(201,180,88,.35); background:rgba(201,180,88,.07)}
    .toggle{
      display:none; background:transparent; color:var(--text);
      border:1px solid var(--line); border-radius:12px; padding:10px 12px;
      cursor:pointer;
    }

    /* Layout */
    main{max-width:var(--max); margin:0 auto; padding:22px 18px 60px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--r2);
      box-shadow:var(--shadow);
    }
    .pad{padding:22px}

    .h1{
      font-weight:700;
      font-size:clamp(38px, 4.4vw, 64px);
      line-height:1.02;
      margin:0 0 14px;
      letter-spacing:-.01em;
    }
    .h2{
      font-weight:700;
      font-size:clamp(24px, 3vw, 36px);
      margin:0 0 10px;
      letter-spacing:-.01em;
    }
    .p{color:var(--muted); line-height:1.65; font-size:15px}

    .badge{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      border-radius:999px;
      padding:8px 10px;
      color:var(--muted);
      font-size:12px;
      margin-bottom:14px;
      text-decoration:none;
      cursor:pointer;
      transition: transform 180ms cubic-bezier(.2,.8,.2,1), border-color 180ms, background 180ms;
    }
    .badge:hover{
      border-color: rgba(201,180,88,.38);
      background: rgba(201,180,88,.08);
      transform: translateY(-1px);
    }
    .badge .bdot{width:7px; height:7px; border-radius:50%; background:rgba(233,233,234,.38)}

    .actions{display:flex; gap:12px; flex-wrap:wrap; margin-top:18px}
    .btn{
      display:inline-flex; gap:10px; align-items:center; justify-content:center;
      padding:11px 14px; border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--text); text-decoration:none; font-size:13px;
      cursor:pointer;
    }
    .btn:hover{border-color:rgba(201,180,88,.38); background:rgba(201,180,88,.08)}
    .btn.primary{border-color:rgba(201,180,88,.55); background:rgba(201,180,88,.12)}
    .btn.primary:hover{background:rgba(201,180,88,.18)}
    .small{font-size:12px; color:var(--muted); line-height:1.6}
    .red{ color:#ff4d4d; }

    /* Footer */
    footer{border-top:1px solid var(--line); padding:20px 18px 28px; color:var(--muted)}
    .footerInner{max-width:var(--max); margin:0 auto; display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap}
    .footerTitle{color:var(--text); font-weight:600}
    .footerMeta{font-size:12px}

    /* Modal (text) */
    .modalRoot{position:fixed; inset:0; z-index:60; display:none}
    .modalRoot.open{display:block}
    .backdrop{position:absolute; inset:0; background:rgba(0,0,0,.62)}
    .modal{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:min(720px, calc(100% - 24px));
      border-radius:var(--r2);
      border:1px solid rgba(233,233,234,.16);
      background:linear-gradient(180deg, rgba(15,17,23,.96), rgba(15,17,23,.92));
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .modalHeader{
      display:flex; justify-content:space-between; gap:12px; align-items:flex-start;
      padding:16px 16px 10px;
      border-bottom:1px solid rgba(233,233,234,.10)
    }
    .modalTitle{font-weight:700; font-size:18px; margin:0}
    .modalClose{
      background:transparent; color:var(--text);
      border:1px solid rgba(233,233,234,.14);
      border-radius:12px; padding:8px 10px; cursor:pointer
    }
    .modalBody{padding:14px 16px 18px; color:var(--muted); line-height:1.65}

    /* Fullscreen Image Modal */
    .imgModal{position:fixed; inset:0; z-index:9999; display:none}
    .imgModal.open{display:block}
    .imgBackdrop{position:absolute; inset:0; background:rgba(0,0,0,.78)}
    .imgStage{position:absolute; inset:0; display:flex; align-items:center; justify-content:center}
    .imgStage img{width:100vw; height:100vh; object-fit:contain}
    .imgClose{
      position: fixed;
      top:16px; right:16px;
      width:44px; height:44px;
      border-radius: 12px;
      border:1px solid rgba(233,233,234,.18);
      background: rgba(0,0,0,.30);
      color:#fff;
      cursor:pointer;
      font-size:18px;
      z-index: 2;
    }
    .imgClose:hover{ background: rgba(0,0,0,.42); }

    /* Skeleton / images */
    .imgWrap{ position:relative; width:100%; }
    .imgSkeleton{
      height: 360px;
      border-radius:16px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(233,233,234,.65);
      font-size: 13px;
    }
    .imgSkeleton.hide{ display:none; }
    .pageImg{ width:100%; height:auto; display:block; border-radius:16px; border:1px solid rgba(233,233,234,.12); background:rgba(0,0,0,.16); }

    /* =========================
       HOME (Framer-like)
       ========================= */
    .homeSplit{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 22px;
      align-items: stretch;
      min-height: 72vh;
    }
    .homeLeft{
      padding: 34px 10px 20px 6px;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .homeTitle{
      font-weight:700;
      font-size: clamp(36px, 4.2vw, 58px);
      line-height: 1.05;
      margin: 0 0 18px;
      letter-spacing:-.02em;
    }
    .homeSub{
      font-size: clamp(20px, 2.2vw, 28px);
      font-weight: 600;
      margin: 0 0 14px;
      color: rgba(233,233,234,.92);
    }
    .homeDesc{
      max-width: 520px;
      color: rgba(233,233,234,.68);
      line-height: 1.65;
      font-size: 15px;
      margin: 0 0 22px;
    }

    /* Right hero media */
    .heroMedia{
      position:relative;
      border-radius: 26px;
      overflow:hidden;
      border: 1px solid rgba(233,233,234,.14);
      background: rgba(0,0,0,.22);
      min-height: 560px;
      box-shadow: 0 18px 50px rgba(0,0,0,.55);
      transform: translateY(0);
    }
    .heroMedia::before{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(105deg, rgba(0,0,0,.55), rgba(0,0,0,.10)),
        url("hero-lincoln-park.jpg");
      background-size: cover;
      background-position: center;
      filter: grayscale(1) contrast(1.05);
      transform: scale(1.01);
      opacity:.9;
    }
    .heroMedia::after{
      content:"";
      position:absolute; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.16'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.30;
      pointer-events:none;
    }
    .heroPreview{
      position:absolute; inset:0;
      z-index:2;
      pointer-events:none;
    }
    .heroPreview img{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      filter: grayscale(1) contrast(1.05);
      opacity:0;
      transition: opacity 1200ms cubic-bezier(.2,.8,.2,1);
      transform: scale(1.01);
    }
    .heroPreview img.show{ opacity:1; }
    .heroOverlay{ position:relative; z-index:3; height:100%; padding:26px; display:flex; }
    .heroTimeline{ display:flex; flex-direction:column; gap:14px; margin-top:6px; }
    .heroTimeline a{
      color: rgba(226,203,105,.98);
      text-decoration:none;
      font-size: 15px;
      font-weight: 700;
      letter-spacing: .02em;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid transparent;
      width: fit-content;
      text-shadow: 0 2px 10px rgba(0,0,0,.75), 0 0 2px rgba(0,0,0,.85);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(2px);
    }
    .heroTimeline a:hover{
      border-color: rgba(226,203,105,.55);
      background: rgba(0,0,0,.26);
    }
    .heroTimeline a.active{
      border-color: rgba(226,203,105,.80);
      background: rgba(0,0,0,.32);
    }
    .heroTeaser{
      position:absolute;
      left: 26px; bottom: 26px;
      max-width: 360px;
      border: 1px solid rgba(233,233,234,.14);
      background: rgba(0,0,0,.26);
      border-radius: 16px;
      padding: 12px 12px;
      color: rgba(233,233,234,.82);
      font-size: 12px;
      line-height: 1.55;
      opacity: .95;
      z-index:3;
    }

    /* Home background video */
    .bgVideoWrap{
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      overflow: hidden;
    }
    .bgVideo{
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.30;
      filter: grayscale(1) contrast(1.05) blur(1px);
      transform: scale(1.02);
    }
    .bgVideoWrap::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(900px 600px at 30% 10%, rgba(0,0,0,.35), rgba(0,0,0,.70));
    }

    /* =========================
       TIMELINE PAGE
       ========================= */
    .section{margin-top:22px; display:grid; grid-template-columns:280px 1fr; gap:18px}
    .sticky{position:sticky; top:86px; align-self:start}
    .side{padding:16px}
    .sideTitle{font-size:12px; color:var(--muted); letter-spacing:.2px; text-transform:uppercase; margin-bottom:10px}
    .sideNav{display:flex; flex-direction:column; gap:8px}
    .sideNav button{
      text-align:left; width:100%;
      border-radius:14px; border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--muted);
      padding:10px 12px;
      cursor:pointer;
    }
    .sideNav button:hover{color:var(--text); border-color:rgba(201,180,88,.38)}
    .sideNav button.active{color:var(--text); border-color:rgba(201,180,88,.55); background:rgba(201,180,88,.08)}

    .scene{
      padding:18px; border-radius:var(--r2);
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      margin-bottom:14px;
    }
    .sceneHeader{display:flex; justify-content:space-between; gap:12px; align-items:flex-start; margin-bottom:10px}
    .sceneTitle{font-weight:800; font-size:22px; margin:0}
    .sceneMeta{color:rgba(201,180,88,.95); font-size:12px; margin-top:4px}
    .narration{color:var(--muted); line-height:1.65; font-size:14px}
    .choice{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .choice button{
      border-radius:999px; border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--text);
      padding:10px 12px;
      cursor:pointer; font-size:13px;
    }
    .choice button:hover{border-color:rgba(201,180,88,.45); background:rgba(201,180,88,.08)}
    .reveal{
      margin-top:10px; border:1px solid rgba(233,233,234,.12);
      background:rgba(0,0,0,.18);
      padding:12px; border-radius:16px;
      color:var(--muted); line-height:1.6;
      display:none;
      white-space:pre-line;
      font-size:13px;
    }

    /* Intro: cinematic lines + perspective + quiz */
    .introLines{ margin-top:22px; max-width:720px; }
    .introLine{
      opacity: 0;
      transform: translateY(10px);
      animation: introFade 1.2s cubic-bezier(.2,.8,.2,1) forwards;
      animation-delay: calc(var(--d) * 0.6s);
      font-size: 15px;
      line-height: 1.7;
      color: rgba(233,233,234,.85);
      margin: 0 0 10px;
    }
    @keyframes introFade{ to{ opacity:1; transform:translateY(0); } }

    .perspBar{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      margin-top:14px;
      padding:10px 12px;
      border:1px solid rgba(233,233,234,.12);
      background:rgba(0,0,0,.14);
      border-radius:16px;
    }
    .perspTag{ font-size:12px; color:rgba(233,233,234,.75); }
    .perspBtn{
      border-radius:999px;
      border:1px solid rgba(255,77,77,.55);
      background:#ff4d4d;
      color:#fff;
      padding:10px 14px;
      cursor:pointer;
      font-size:13px;
      font-weight:800;
      letter-spacing:.02em;
      box-shadow: 0 10px 26px rgba(255,77,77,.18), 0 0 0 6px rgba(255,77,77,.10);
      transition: transform 180ms cubic-bezier(.2,.8,.2,1), filter 180ms, box-shadow 180ms;
    }
    .perspBtn:hover{
      transform: translateY(-1px) scale(1.02);
      filter: brightness(1.03);
      box-shadow: 0 14px 34px rgba(255,77,77,.24), 0 0 0 8px rgba(255,77,77,.12);
    }

    .quizBox{
      margin-top:14px;
      border:1px solid rgba(233,233,234,.12);
      background:rgba(0,0,0,.16);
      border-radius:18px;
      padding:12px;
    }
    .quizQ{ font-size:13px; color:rgba(233,233,234,.85); margin:0 0 10px; }
    .quizReveal{
      margin-top:10px;
      display:none;
      color:rgba(233,233,234,.72);
      line-height:1.6;
      font-size:13px;
      border-top:1px solid rgba(233,233,234,.10);
      padding-top:10px;
      white-space:pre-line;
    }

    /* =========================
       Act I (1865–1871): vertical stack
       ========================= */
    .vStack{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.22);
      margin-top:12px;
    }
    .vStack::before{
      content:"";
      position:absolute; inset:0;
      background: url("1865-bg.png") center/cover no-repeat;
      opacity:.50;
      pointer-events:none;
    }
    .vStack::after{
      content:"";
      position:absolute; inset:0;
      background: rgba(0,0,0,.60);
      pointer-events:none;
    }
    .vStackInner{
      position:relative;
      z-index:1;
      padding:16px;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:center;
    }
    .vShot{
      width:min(880px, 100%);
      border-radius:16px;
      overflow:hidden;
      border:1px solid rgba(233,233,234,.14);
      background: rgba(0,0,0,.22);
      cursor: zoom-in;
      transition: transform 220ms cubic-bezier(.2,.8,.2,1), border-color 220ms;
    }
    .vShot:hover{
      transform: translateY(-2px);
      border-color: rgba(201,180,88,.45);
    }
    .vCaption{
      width:min(880px, 100%);
      border-radius:16px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      padding:12px 14px;
      color: rgba(233,233,234,.78);
      line-height:1.65;
      font-size:13px;
    }
    .vCapTitle{
      font-weight:800;
      font-size:13px;
      color: rgba(233,233,234,.92);
      margin:0 0 6px;
    }
    .vCapText{ margin:0; color: rgba(233,233,234,.70); }

    /* =========================
       1871 Fire — Page 1 (clean)
       ========================= */
    .fireP1{
      position: relative;
      border-radius: 22px;
      overflow: hidden;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      margin-top:12px;
    }
    .fireGlow{
      position:absolute;
      inset:0;
      background:
        radial-gradient(700px 420px at 30% 25%, rgba(255,120,50,.18), transparent 62%),
        radial-gradient(820px 520px at 75% 60%, rgba(255,70,20,.14), transparent 65%),
        url("fire_glow.png");
      background-size: cover;
      background-position: center;
      mix-blend-mode: screen;
      opacity: .20;
      pointer-events:none;
      animation: fireBreath 4s ease-in-out infinite;
      filter: blur(.2px) saturate(1.05);
    }
    @keyframes fireBreath{
      0%   { opacity:.16; transform: scale(1.00); }
      50%  { opacity:.22; transform: scale(1.02); }
      100% { opacity:.16; transform: scale(1.00); }
    }
    .fireInner{
      position: relative;
      z-index: 1;
      padding: 16px;
      display: grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 16px;
      align-items:start;
    }
    .fireLeft{ display:flex; flex-direction:column; gap:12px; }
    .fireP1Grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .fireBlock{
      border-radius: 18px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.22);
      padding: 14px;
    }
    .fireLabel{
      font-size: 12px;
      color: rgba(201,180,88,.92);
      margin-bottom: 8px;
      letter-spacing: .02em;
    }
    .fireText{
      font-size: 13px;
      line-height: 1.7;
      color: rgba(233,233,234,.78);
      margin: 0;
      white-space: pre-line;
    }
    .fireTitle{
      font-weight: 900;
      font-size: 16px;
      margin: 0 0 8px;
      color: rgba(233,233,234,.92);
      letter-spacing:-.01em;
    }
    .fireRight{ display:flex; flex-direction:column; gap:12px; }
    .fireMain{
      position: relative;
      border-radius: 18px;
      overflow: hidden;
      border:1px solid rgba(233,233,234,.14);
      background: rgba(0,0,0,.22);
      height: 520px;
    }
    .fireMain img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover;
      filter: grayscale(1) contrast(1.05);
      opacity: 1;
      transition: opacity 800ms ease-in-out;
    }
    .seasonRow{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    .seasonCard{
      border-radius: 16px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      padding: 10px 10px;
      cursor:pointer;
      transition: transform 250ms cubic-bezier(.2,.8,.2,1), border-color 250ms, background 250ms;
      user-select:none;
    }
    .seasonCard:hover{
      transform: translateY(-2px);
      border-color: rgba(201,180,88,.40);
      background: rgba(201,180,88,.06);
    }
    .seasonName{
      font-size: 12px;
      font-weight: 800;
      color: rgba(233,233,234,.88);
      margin-bottom: 6px;
    }
    .seasonHint{
      font-size: 12px;
      color: rgba(233,233,234,.62);
      line-height: 1.5;
    }
    .fireNarrative{
      opacity: 0;
      transform: translateY(6px);
      transition: opacity 600ms ease, transform 600ms ease;
    }
    .fireNarrative.show{ opacity:1; transform: translateY(0); }

    /* =========================
       1871–1900 — Vertical stages (S3)
       ========================= */
    .s3Wrap{
      display:flex;
      flex-direction:column;
      gap:14px;
      margin-top:12px;
    }
    .s3Card{
      border-radius:18px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      overflow:hidden;
    }
    .s3Stage{
      position:relative;
      min-height: 360px;
      border-bottom:1px solid rgba(233,233,234,.10);
      background: rgba(0,0,0,.22);
    }
    .s3Stage::before{
      content:"";
      position:absolute; inset:0;
      background: var(--s3bg) center/cover no-repeat;
      filter: grayscale(1) contrast(1.05);
      opacity: 1;
    }
    .s3Stage::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.55));
    }
    .s3StageInner{ position:relative; z-index:1; height:100%; }
    .s3Pad{ padding:14px; }
    .s3Title{
      font-weight:900;
      font-size: 18px;
      margin:0 0 8px;
      color: rgba(233,233,234,.92);
      letter-spacing:-.01em;
    }
    .s3Text{
      font-size: 13px;
      line-height: 1.75;
      color: rgba(233,233,234,.78);
      margin:0;
      white-space: pre-line;
    }
    .s3Hint{
      margin-top:10px;
      font-size:12px;
      color: rgba(233,233,234,.62);
    }
    .s3Marker{
      position:absolute;
      transform: translate(-50%, -50%);
      width: 40px; height: 40px;
      border-radius: 999px;
      border:1px solid rgba(201,180,88,.55);
      background: rgba(0,0,0,.28);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 10px 26px rgba(0,0,0,.45);
      transition: transform 200ms cubic-bezier(.2,.8,.2,1), background 200ms;
      user-select:none;
    }
    .s3Marker:hover{
      transform: translate(-50%, -50%) scale(1.06);
      background: rgba(201,180,88,.10);
    }
    .s3Marker span{
      color: rgba(201,180,88,.95);
      font-weight: 900;
      font-size: 16px;
    }
    .s3Reveal{
      display:none;
      margin-top:10px;
      border:1px solid rgba(233,233,234,.12);
      background: rgba(0,0,0,.18);
      border-radius:16px;
      padding:12px;
      color: rgba(233,233,234,.74);
      font-size:13px;
      line-height:1.65;
      white-space: pre-line;
    }
    .s3Reveal.show{ display:block; }

    /* =========================
       Characters
       ========================= */
    .kgrid{display:grid; grid-template-columns:repeat(3, 1fr); gap:14px}
    .kcard{
      padding:16px; border:1px solid var(--line);
      border-radius:var(--r2); background:rgba(255,255,255,.02);
      cursor:pointer;
      transition: border-color 180ms, background 180ms, transform 180ms;
    }
    .kcard:hover{border-color:rgba(201,180,88,.38); background:rgba(201,180,88,.06); transform:translateY(-1px)}
    .krole{color:rgba(201,180,88,.95); font-size:12px}
    .kname{font-weight:900; font-size:18px; margin:8px 0}
    .kdesc{color:var(--muted); font-size:13px; line-height:1.6}

    /* =========================
       Archive
       ========================= */
    .filters{display:flex; gap:10px; flex-wrap:wrap; margin:12px 0 10px}
    .chip{
      border-radius:999px; border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--muted);
      padding:9px 11px; cursor:pointer; font-size:13px;
    }
    .chip.active{color:var(--text); border-color:rgba(201,180,88,.55); background:rgba(201,180,88,.08)}
    .archiveGrid{display:grid; grid-template-columns:repeat(3,1fr); gap:14px}
    .aItem{border:1px solid var(--line); border-radius:var(--r2); background:rgba(255,255,255,.02); overflow:hidden}
    .aThumb{height:140px; background:rgba(0,0,0,.25)}
    .aBody{padding:14px}
    .aTag{color:rgba(201,180,88,.95); font-size:12px}
    .aTitle{margin:8px 0 6px; font-weight:700}
    .aMeta{color:var(--muted); font-size:12px; line-height:1.55}

    /* =========================
       Now & Then
       ========================= */
    .compareWrap{padding:18px}
    .compare{
      position:relative; border-radius:var(--r2); overflow:hidden;
      border:1px solid var(--line); background:rgba(0,0,0,.25); height:420px;
    }
    .compare .base, .compare .top{position:absolute; inset:0}
    .compare svg{width:100%; height:100%; display:block}
    .compare .top{clip-path: inset(0 50% 0 0)}
    .slider{width:100%; margin-top:12px}

    /* Responsive */
    @media (max-width:980px){
      nav{display:none}
      .toggle{display:inline-flex}
      nav.open{
        display:flex; position:absolute; top:58px; left:12px; right:12px;
        flex-direction:column; background:rgba(11,12,15,.96);
        border:1px solid var(--line); border-radius:18px; padding:10px;
      }
      .homeSplit{ grid-template-columns: 1fr; }
      .heroMedia{ min-height: 420px; }
      .section{grid-template-columns:1fr}
      .sticky{position:relative; top:auto}
      .kgrid{grid-template-columns:1fr}
      .archiveGrid{grid-template-columns:1fr}
      .fireInner{ grid-template-columns:1fr; }
      .fireP1Grid{ grid-template-columns:1fr; }
      .seasonRow{ grid-template-columns: repeat(2, 1fr); }
      .fireMain{ height:360px; }
    }
  </style>
</head>

<body>
  <a class="skip" href="#main">Skip to content</a>

  <header>
    <div class="brand">
      <div class="dot"></div>
      <div>
        <div class="brand__title">PoliTo Digital Heritage</div>
        <div class="brand__sub">Lincoln Park in the Great Chicago Fire Research Group</div>
      </div>
    </div>

    <nav id="nav">
      <a href="#/" data-link>Home</a>
      <a href="#/timeline" data-link>Timeline</a>
      <a href="#/characters" data-link>Characters</a>
      <a href="#/archive" data-link>Archive</a>
      <a href="#/now-then" data-link>Now &amp; Then</a>
      <a href="#/about" data-link>About</a>
    </nav>

    <button class="toggle" id="toggle" aria-label="Toggle menu" aria-expanded="false">☰</button>
  </header>

  <main id="main" aria-live="polite"></main>

  <footer>
    <div class="footerInner">
      <div>
        <div class="footerTitle">From ashes to green</div>
        <div class="footerMeta">A minimal, cinematic digital heritage prototype.</div>
      </div>
      <div class="footerMeta">© <span id="year"></span> — PoliTo Digital Heritage (placeholder).</div>
    </div>
  </footer>

  <div id="modalRoot" class="modalRoot" aria-hidden="true"></div>
  <div id="imgModal" class="imgModal" aria-hidden="true"></div>

<script>
'use strict';

/* =========================
   Helpers
   ========================= */
const $main = document.getElementById('main');
const $year = document.getElementById('year');
const $modalRoot = document.getElementById('modalRoot');
const $imgModal = document.getElementById('imgModal');
const $nav = document.getElementById('nav');
const $toggle = document.getElementById('toggle');

$year.textContent = String(new Date().getFullYear());

function escapeHtml(s){
  return String(s)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'","&#039;");
}
function formatParagraphs(text){
  const safe = escapeHtml(text);
  return safe.split('\n').map(p=>`<p style="margin:0 0 10px;">${p}</p>`).join('');
}

/* Archival-like SVG placeholder (no assets needed) */
function svgPhoto(label){
  const safe = escapeHtml(label);
  return `
  <svg viewBox="0 0 1200 700" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="${safe}">
    <defs>
      <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0" stop-color="#111217"/>
        <stop offset="1" stop-color="#07080b"/>
      </linearGradient>
      <filter id="grain">
        <feTurbulence type="fractalNoise" baseFrequency=".8" numOctaves="2" stitchTiles="stitch"/>
        <feColorMatrix type="saturate" values="0"/>
        <feComponentTransfer><feFuncA type="table" tableValues="0 0.22"/></feComponentTransfer>
      </filter>
      <filter id="soft"><feGaussianBlur stdDeviation="1.2"/></filter>
    </defs>
    <rect width="1200" height="700" fill="url(#g)"/>
    <g opacity=".9" filter="url(#soft)">
      <path d="M0,520 C180,470 260,600 420,540 C620,460 710,610 910,520 C1040,462 1120,480 1200,450 L1200,700 L0,700 Z" fill="#0b0c0f"/>
      <path d="M0,430 C200,380 260,480 430,430 C640,350 700,520 920,420 C1060,372 1120,380 1200,350" fill="none" stroke="rgba(233,233,234,.12)" stroke-width="2"/>
      <path d="M120,220 C260,160 320,250 480,210 C670,160 730,270 900,210" fill="none" stroke="rgba(233,233,234,.10)" stroke-width="2"/>
    </g>
    <g opacity=".35" filter="url(#grain)"><rect width="1200" height="700" fill="#fff"/></g>
    <text x="42" y="64" font-family="Inter, sans-serif" font-size="18" fill="rgba(233,233,234,.62)">ARCHIVAL PLACEHOLDER</text>
    <text x="42" y="96" font-family="Inter, sans-serif" font-weight="700" font-size="34" fill="rgba(233,233,234,.86)">${safe}</text>
  </svg>`; 
}

/* =========================
   Data
   ========================= */
const TIMELINE = [
  { id:'intro', label:'Intro', teaser:'What “heritage” means — and why it matters in this story.' },
  { id:'1865-1871', label:'1865–1871', teaser:'A lakeside edge: cemetery traces, landfill, a city in acceleration.' },
  { id:'1871', label:'1871', teaser:'Fire night. Lincoln Park becomes a disaster boundary and temporary refuge.' },
  { id:'1871-1900', label:'1871–1900', teaser:'Rebuilding politics, public health, and the slow making of civic green.' },
  { id:'1900-1930', label:'1900–1930', teaser:'Plans, promenades, and the City Beautiful era reshaping public space.' },
  { id:'now-then', label:'Now and Then', teaser:'Memory layered on everyday life: the park as archive and living stage.' }
];

const SCENES = [
  {
    id:'intro',
    title:'Intro — “What is Heritage?”',
    meta:'Entry',
    perspectives:{
      architect:{
        narration:`First, let’s pause our identities as architects, designers, or planners.
For a moment, step back from plans, from form, from expertise.`,
        lines:[
          'We are trained to read cities through systems: zoning, circulation, infrastructure.',
          'But a catastrophe does not begin as a design problem.',
          'It begins as a human condition — fear, loss, survival.'
        ],
        mediaLabel:'Intro · plans / diagrams (placeholder)'
      },
      citizen:{
        narration:`First, I want all of us to step away from our identities as architects,
designers, or planners.

Let’s return to the most fundamental identity we share
when looking at the Great Chicago Fire —
a citizen.`,
        lines:[
          'Cities are not only built by plans, but by the belief of people to rebuild.',
          'From the ruins, tent cities appeared — fragile, but full of humanity.',
          'They show us that public space can grow from empathy and survival, not just from formal planning.',
          'Through digital heritage, we redefine the city:',
          'not as monuments or skylines, but as the shared will of people to rebuild.'
        ],
        mediaLabel:'Intro · tent city / refuge camps (placeholder)'
      }
    },
    quiz:{
      question:'What defines a city, at its most fragile moment?',
      options:[
        { key:'plans', label:'A. Plans and regulations', reveal:'Plans matter — but history suggests cities survive first through people. Plans follow later.' },
        { key:'people', label:'B. People and mutual support', reveal:'History suggests cities survive first through people — plans follow later.' }
      ]
    },
    interactive:{ type:'link', label:'Jump to Act I', to:'#/timeline' }
  },
  {
    id:'1865-1871',
    title:'Act I — “Edges of a Growing City”',
    meta:'1865–1871',
    narration:'Before the fire, Lincoln Park’s landscape holds contradictions: burial grounds, lake winds, and a city expanding northward.',
    interactive:{ type:'none' }
  },
  {
    id:'1871',
    title:'Act II — “Fire Night: The Refuge Line”',
    meta:'October 1871',
    narration:'Lincoln Park becomes a threshold: where the burning city meets open air, where people gather because there is nowhere else to go.',
    interactive:{
      type:'choice',
      prompt:'Choose what the city wants most on that night:',
      options:[
        { key:'blame', label:'Blame the cow', reveal:'A simple culprit travels faster than complex conditions. Blame stabilizes fear — it gives loss a single face.' },
        { key:'conditions', label:'Look at the dry city', reveal:'Wood, wind, drought, dense blocks — a system ready to ignite. The “cause” is not one barn; it is an urban condition.' }
      ]
    }
  },
  {
    id:'1871-1900',
    title:'Act III — “Rebuilding, Public Health, and Making Green”',
    meta:'1871–1900',
    narration:'After catastrophe, “park” becomes policy, infrastructure, and social negotiation — land is filled, paths are traced, habits are formed.',
    interactive:{ type:'none' }
  },
  {
    id:'1900-1930',
    title:'Act IV — “Plans & Promenades”',
    meta:'1900–1930',
    narration:'Design voices professionalize the park. Boulevards, scenery, and civic ideals shape a new public stage.',
    interactive:{ type:'none' }
  },
  {
    id:'now-then',
    title:'Act V — “Now & Then: A Living Archive”',
    meta:'Now',
    narration:'The same ground carries different times. Memory can be seen when you learn what to look for.',
    interactive:{ type:'link', label:'Open comparison', to:'#/now-then' }
  }
];

const CHARACTERS = [
  { role:'Witness', name:'Refugee A', desc:'Carries rumors and grief through the fire night — a human sensor of fear and blame.',
    body:'What they see: crowds, smoke, whispers.\nWhat they argue: blame is emotional shelter.\nSuggested archive: newspaper accounts, refugee camp notes, boundary maps.' },
  { role:'Witness', name:'Refugee B', desc:'Pushes back against easy stories — insists the city itself was ready to burn.',
    body:'What they see: tinder-dry blocks, wind, systemic conditions.\nWhat they argue: disasters are urban systems, not single villains.\nSuggested archive: building materials data, weather records, fire spread maps.' },
  { role:'Landscape / Planning', name:'Annette E. McCrea', desc:'Early landscape voice — attentive to lived public space, atmosphere, and social use.',
    body:'What they see: edges turning into civic green.\nWhat they argue: parks must feel humane, not sterile.\nSuggested archive: plans, committee letters, early park improvement reports.' },
  { role:'Landscape Architect', name:'Ossian Cole Simonds', desc:'Naturalistic sensibility — composition, experience, and ecological feeling.',
    body:'What they see: landscape as a teacher.\nWhat they argue: form guides behavior gently.\nSuggested archive: planting plans, promenade photos, design essays.' },
  { role:'City Planning', name:'Edward H. Bennett', desc:'City Beautiful era voice — circulation, vistas, civic order and monumental structure.',
    body:'What they see: the park as part of the metropolitan system.\nWhat they argue: beauty as a public tool.\nSuggested archive: planning diagrams, boulevard networks, institutional reports.' }
];

const ARCHIVE = [
  { tag:'Map', title:'Fire spread boundary sketch (placeholder)', meta:'Year: 1871 · Source: (add repository)' },
  { tag:'Photo', title:'Lincoln Park promenade (placeholder)', meta:'Year: 1890s · Source: (add repository)' },
  { tag:'Plan', title:'Park improvements proposal (placeholder)', meta:'Year: 1900 · Source: (add repository)' },
  { tag:'Newspaper', title:'Rumor & blame narratives (placeholder)', meta:'Year: 1871 · Source: (add repository)' },
  { tag:'Report', title:'Public health & urban green (placeholder)', meta:'Year: 1880s · Source: (add repository)' },
  { tag:'Photo', title:'Lakefront edge (placeholder)', meta:'Year: 1860s · Source: (add repository)' }
];

const ACT1_IMAGES = [
  {
    src:'1865-1.png',
    title:'1865 — Plat of Cemetery Park (Sheet I)',
    text:'An early plat where “park” is still a boundary condition—between burial grounds, shoreline forces, and a city beginning to push north.'
  },
  {
    src:'1865-2.png',
    title:'1865 — Plat of Cemetery Park (Sheet II)',
    text:'Paths and parcels appear as a proto-logic: circulation and order are imagined, but the landscape remains unfinished and contested.'
  },
  {
    src:'1865-3.png',
    title:'1871 — Plan of Lincoln Park (Sheet I)',
    text:'A shift toward planned space: clearer edges, circulation intent, and an emerging public ground—right before the fire rewrites priorities.'
  },
  {
    src:'1865-4.png',
    title:'1871 — Plan of Lincoln Park (Sheet II)',
    text:'The park begins to read as a system, not just a site. Yet in catastrophe, systems are tested by the needs of people.'
  }
];

const FIRE_1871_P1 = {
  title: "PAGE 1 — Couch Tomb · Intro",
  a1_title: "P1-A1 · Title & Intro",
  a1_text: "The stone Couch Tomb was built in 1858 along the northern edge of the City Cemetery. During the Great Chicago Fire, the surrounding wooden structures were destroyed, but the tomb survived due to its solid stone structure—becoming the only remaining above-ground cemetery relic in today’s Lincoln Park. It is often referred to as “the lone survivor of the City Cemetery.”",
  a2_title: "P1-A2 · Narrative Paragraph",
  a2_text: "Time shifts, the world changes, flames rise everywhere—yet the stone tomb stands unmoved. Fire engulfs wooden fences and headstones, but the stone Couch Tomb reflects a glowing orange light in the sea of fire.",
  a3_title: "P1-A3 · Seasonal Timeline",
  seasons: [
    { key:"autumn", label:"Autumn", src:"couch_autumn.jpg", hint:"Before the fire, the cemetery still resembled an ordinary resting place." },
    { key:"winter", label:"Winter", src:"couch_winter.jpg", hint:"Snow covered the scars of destruction, as if the city tried to forget." },
    { key:"spring", label:"Spring", src:"couch_spring.jpg", hint:"Relocation began. Graves were moved. Memory was displaced." },
    { key:"summer", label:"Summer", src:"couch_summer.jpg", hint:"The cemetery disappeared. A park quietly emerged." }
  ]
};

const S3_1871_1900 = {
  intro: {
    title: "Intro — Dawn After the End",
    bg: "s3_1871-1900_intro_bg.jpg",
    hint: "Click the icons to hear how they experienced this night.",
    markers: [
      {
        id:"elder",
        x: 42, y: 36,
        speech:
`“We gathered in Lincoln Park because there was nowhere else to go.
At that time, this place was still an open ground — part cemetery, part grassland, part marsh.
We were homeless, and this was one of the few large areas in the northern city without buildings.”`
      },
      {
        id:"family",
        x: 78, y: 44,
        speech:
`“We used burned wood, broken bricks, and whatever we could pull from the ruins
to build temporary shelters and tents.
The park became a vast refugee camp — fragile, silent, and filled with people like us.”`
      },
      {
        id:"fire",
        x: 60, y: 50,
        speech:
`“The fire gave warmth, but it also marked fear.
It lit our faces, stretched our shadows, and reminded us how close everything still was to collapse.”`
      }
    ],
    narration:
`After the fire, Lincoln Park became a fragile refuge line.

Elderly men, women, and children gathered around small fires — not to celebrate, but to survive.

What emerged here was not a designed space, but a moment of shared vulnerability:
a city stripped of walls, buildings, and certainty.`
  },

  acts: [
    {
      id:"act1",
      title:"Act I — A Collective Without Names",
      bg:"s3_1871-1900_act1_bg.jpg",
      narration:
`October 9–10, 1871.

In the first morning after the fire, survivors drifted north without direction.
A woman holding the only blanket she managed to save followed the flow of people until she reached Lincoln Park.

The lakeshore, the cold wind, and the open ground turned this place into a temporary shelter — shared by strangers who had lost everything.`
    },
    {
      id:"act2",
      title:"Act II — Survival in the Park",
      bg:"s3_1871-1900_act2_bg.jpg",
      narration:
`In the first week after the disaster, survival became a daily struggle.
People lined up for bread and coffee distributed by relief committees.

On a wooden crate, a man stood above the crowd, organizing volunteers, directing supplies, and calling for order amid exhaustion.`,
      marker:{ x:68, y:30, speech:`“There is no curfew here, but we cannot become animals. If we want to survive together, we need our own order.”` }
    },
    {
      id:"act3",
      title:"Act III — Order and Compassion",
      bg:"s3_1871-1900_act3_bg.jpg",
      narration:
`The Chicago Relief and Aid Society soon emerged, coordinating resources across multiple camps, including Lincoln Park.
Food distribution, medical assistance, and basic rules began to take shape.

Order here was not imposed by force, but formed through mutual necessity.`,
      marker:{ x:74, y:36, speech:`“Every day we maintain order on site, making sure everyone receives what they need. We help people find their families and friends.”` }
    },
    {
      id:"act4",
      title:"Act IV — An Office in the Park",
      bg:"s3_1871-1900_act4_bg.jpg",
      narration:
`October 12.
At the edge of Lincoln Park, Bertha Honoré Palmer and members of the Women’s Relief and Aid Society established a coordination point.

A school desk became their office. Maps and handwritten lists replaced formal plans.`,
      marker:{ x:70, y:42, speech:
`Bertha Honoré Palmer (1849–1918)

A prominent Chicago philanthropist and social leader.
She played a key role in organizing early relief after the fire, coordinating donations, logistics, and social support.
Later, she served as President of the Board of Lady Managers for the 1893 World’s Columbian Exposition.`
      }
    },
    {
      id:"act5",
      title:"Act V — Seeds of Rebuilding",
      bg:"s3_1871-1900_act5_bg.jpg",
      narration:
`By the late 1870s and into the 1890s, Lincoln Park slowly shifted again.

People who once sought refuge here began to rebuild elsewhere — but the memory remained.

The park carried the imprint of loss, cooperation, and renewal.`
    }
  ]
};

/* =========================
   Router
   ========================= */
const routes = {
  '/': viewHome,
  '/timeline': viewTimeline,
  '/characters': viewCharacters,
  '/archive': viewArchive,
  '/now-then': viewNowThen,
  '/what-defines': viewWhatDefines,
  '/about': viewAbout
};

function pathNow(){
  const h = location.hash || '#/';
  const p = h.replace('#','');
  return p.startsWith('/') ? p : '/' + p;
}

function setActiveNav(path){
  document.querySelectorAll('nav a[data-link]').forEach(a=>{
    const href = a.getAttribute('href').replace('#','');
    a.classList.toggle('active', href === path);
  });
}

function ensureHomeVideo(on){
  let wrap = document.getElementById('bgVideoWrap');
  if(on){
    if(wrap) return;
    wrap = document.createElement('div');
    wrap.id = 'bgVideoWrap';
    wrap.className = 'bgVideoWrap';
    wrap.innerHTML = `
      <video class="bgVideo" autoplay muted loop playsinline preload="auto">
        <source src="lincoln_park_8s.mp4" type="video/mp4">
      </video>
    `;
    document.body.appendChild(wrap);
    const v = wrap.querySelector('video');
    if(v){
      const p = v.play();
      if(p && typeof p.catch === 'function') p.catch(()=>{});
    }
  }else{
    if(wrap) wrap.remove();
  }
}

function render(){
  const path = pathNow();
  ensureHomeVideo(path === '/');
  setActiveNav(path);
  $main.innerHTML = '';
  (routes[path] || viewNotFound)();
  window.scrollTo({top:0, behavior:'smooth'});
}

window.addEventListener('hashchange', render);

/* Mobile nav */
$toggle.addEventListener('click', ()=>{
  const open = $nav.classList.toggle('open');
  $toggle.setAttribute('aria-expanded', String(open));
});
document.addEventListener('click', (e)=>{
  const inside = e.target.closest('nav') || e.target.closest('#toggle');
  if(!inside && $nav.classList.contains('open')){
    $nav.classList.remove('open');
    $toggle.setAttribute('aria-expanded','false');
  }
});

/* =========================
   Text modal
   ========================= */
function openModal(title, body){
  $modalRoot.classList.add('open');
  $modalRoot.setAttribute('aria-hidden','false');
  $modalRoot.innerHTML = `
    <div class="backdrop" data-close="1"></div>
    <div class="modal" role="dialog" aria-modal="true" aria-label="${escapeHtml(title)}">
      <div class="modalHeader">
        <h3 class="modalTitle">${escapeHtml(title)}</h3>
        <button class="modalClose" data-close="1">Close</button>
      </div>
      <div class="modalBody">${formatParagraphs(body)}</div>
    </div>
  `;
}
function closeModal(){
  $modalRoot.classList.remove('open');
  $modalRoot.setAttribute('aria-hidden','true');
  $modalRoot.innerHTML = '';
}
$modalRoot.addEventListener('click', (e)=>{ if(e.target.dataset.close) closeModal(); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && $modalRoot.classList.contains('open')) closeModal(); });

/* =========================
   Fullscreen image modal
   ========================= */
function openImgModal(src, title){
  document.body.style.overflow = 'hidden';
  $imgModal.classList.add('open');
  $imgModal.setAttribute('aria-hidden','false');
  $imgModal.innerHTML = `
    <div class="imgBackdrop" data-img-close="1"></div>
    <button class="imgClose" data-img-close="1">✕</button>
    <div class="imgStage">
      <img src="${escapeHtml(src)}" alt="${escapeHtml(title || 'Full image')}">
    </div>
  `;
}
function closeImgModal(){
  document.body.style.overflow = '';
  $imgModal.classList.remove('open');
  $imgModal.setAttribute('aria-hidden','true');
  $imgModal.innerHTML = '';
}
document.addEventListener('click', (e)=>{
  if(e.target.dataset.imgClose) closeImgModal();
});
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape' && $imgModal.classList.contains('open')) closeImgModal();
});

/* =========================
   Intro perspective state
   ========================= */
function getIntroPerspective(){
  return sessionStorage.getItem('persp') || 'architect';
}
function setIntroPerspective(p){
  sessionStorage.setItem('persp', p);
}
function getSceneNarration(scene){
  if(scene.id !== 'intro') return scene.narration || '';
  const p = getIntroPerspective();
  return scene.perspectives?.[p]?.narration || '';
}
function getSceneLines(scene){
  if(scene.id !== 'intro') return null;
  const p = getIntroPerspective();
  return scene.perspectives?.[p]?.lines || null;
}

/* =========================
   Views
   ========================= */
function viewHome(){
  const el = document.createElement('section');
  el.className = 'homeSplit';

  el.innerHTML = `
    <div class="homeLeft">
      <a class="badge" href="#/what-defines"><span class="bdot"></span> What defines a city?</a>
      <h1 class="homeTitle">From ashes to green</h1>
      <div class="homeSub">Lincoln Park in Chicago’s rebirth</div>
      <p class="homeDesc">
        Walk through time, explore evolving landscapes, and see how this park grew from
        refuge to cultural heart, reflecting the city’s resilience and spirit.
      </p>
      <div class="actions">
        <a class="btn" href="#/about" data-link>About us</a>
        <a class="btn primary" href="#/timeline" data-link>Enter Timeline →</a>
      </div>
    </div>

    <div class="heroMedia" id="heroMedia">
      <div class="heroPreview" id="heroPreview">
        <img id="previewImg" alt="" />
      </div>
      <div class="heroOverlay">
        <div class="heroTimeline" id="homeTimeline"></div>
      </div>
      <div class="heroTeaser" id="heroTeaser">
        Hover a chapter to reveal a visual hint, then enter the Timeline to experience memory like a film.
      </div>
    </div>
  `;
  $main.appendChild(el);

  const $list = document.getElementById('homeTimeline');
  const $teaser = document.getElementById('heroTeaser');
  const $media = document.getElementById('heroMedia');
  const $img = document.getElementById('previewImg');

  const PREVIEW_MAP = {
    "intro": "intro.png",
    "1865-1871": "p2_1865-1871.jpg",
    "1871": "p3_1871.jpg",
    "1871-1900": "p4_1871-1900.jpg",
    "1900-1930": "p5_1900-1930.jpg",
    "now-then": "p6_now-then.jpg"
  };

  Object.values(PREVIEW_MAP).forEach(src=>{
    const im = new Image();
    im.src = src;
  });

  TIMELINE.forEach((t, idx)=>{
    const a = document.createElement('a');
    a.href = '#/timeline';
    a.textContent = t.label;

    a.addEventListener('mouseenter', ()=>{
      $teaser.textContent = t.teaser;
      document.querySelectorAll('.heroTimeline a').forEach(x=>x.classList.remove('active'));
      a.classList.add('active');

      const src = PREVIEW_MAP[t.id];
      if(src){
        if ($img.getAttribute('src') !== src) $img.setAttribute('src', src);
        $img.classList.add('show');
      }
      $media.style.transform = `translateY(${idx % 2 === 0 ? -2 : -1}px)`;
      $media.style.transition = 'transform 260ms cubic-bezier(.2,.8,.2,1)';
    });

    a.addEventListener('mouseleave', ()=>{
      $media.style.transform = 'translateY(0px)';
      $img.classList.remove('show');
    });

    a.addEventListener('click', (e)=>{
      e.preventDefault();
      sessionStorage.setItem('act', t.id);
      location.hash = '#/timeline';
    });

    $list.appendChild(a);
  });
}

function viewTimeline(){
  const el = document.createElement('section');
  el.className = 'section';
  el.innerHTML = `
    <aside class="card side sticky">
      <div class="sideTitle">Timeline</div>
      <div class="sideNav" id="sideNav"></div>
      <div class="small" style="margin-top:10px;">
        Scroll for cinematic pacing. Each act has one micro-interaction.
      </div>
    </aside>
    <div id="sceneCol"></div>
  `;
  $main.appendChild(el);

  const $side = document.getElementById('sideNav');
  const $col  = document.getElementById('sceneCol');

  const btns = TIMELINE.map(t=>{
    const b = document.createElement('button');
    b.textContent = t.label;
    b.addEventListener('click', ()=>scrollToScene(t.id));
    $side.appendChild(b);
    return {id:t.id, btn:b};
  });

  SCENES.forEach(s=>{
    const art = document.createElement('article');
    art.className = 'scene';
    art.id = 'scene-' + s.id;

    art.innerHTML = `
      <div class="sceneHeader">
        <div>
          <h3 class="sceneTitle">${escapeHtml(s.title)}</h3>
          <div class="sceneMeta">${escapeHtml(s.meta)}</div>
        </div>
      </div>

      <div class="narration">${formatNarration(s, getSceneNarration(s))}</div>

      ${renderPerspectiveToggle(s)}
      ${renderIntroLines(s, getSceneLines(s))}
      ${renderIntroQuiz(s)}

      ${renderSceneBody(s)}

      ${renderInteractive(s.interactive, s.id)}
    `;
    $col.appendChild(art);
  });

  // Scroll spy
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        const id = en.target.id.replace('scene-','');
        btns.forEach(x=>x.btn.classList.toggle('active', x.id===id));
      }
    });
  }, {threshold:0.35});
  SCENES.forEach(s=>io.observe(document.getElementById('scene-'+s.id)));

  // Open act if selected from home
  const act = sessionStorage.getItem('act');
  if(act){
    sessionStorage.removeItem('act');
    setTimeout(()=>scrollToScene(act), 60);
  }

  // Start fire page default image + narrative fade
  fireP1Autostart();
}

function viewCharacters(){
  const el = document.createElement('section');
  el.className = 'card pad';
  el.innerHTML = `
    <h2 class="h2">Characters</h2>
    <p class="p">
      Script-based perspectives. Each voice highlights a different mechanism of “rebirth”:
      rumor, system, design intention, and civic form.
    </p>
    <div class="kgrid" id="kgrid"></div>
  `;
  $main.appendChild(el);

  const $g = document.getElementById('kgrid');
  CHARACTERS.forEach(c=>{
    const d = document.createElement('div');
    d.className = 'kcard';
    d.innerHTML = `
      <div class="krole">${escapeHtml(c.role)}</div>
      <div class="kname">${escapeHtml(c.name)}</div>
      <div class="kdesc">${escapeHtml(c.desc)}</div>
    `;
    d.addEventListener('click', ()=>openModal(c.name, c.body));
    $g.appendChild(d);
  });
}

function viewArchive(){
  const el = document.createElement('section');
  el.className = 'card pad';
  el.innerHTML = `
    <h2 class="h2">Archive</h2>
    <p class="p">
      A tagged library of maps, photos, plans, reports. Replace placeholders with verified citations and repositories.
    </p>
    <div class="filters" id="filters"></div>
    <div class="archiveGrid" id="agrid"></div>
  `;
  $main.appendChild(el);

  const tags = ['All', ...new Set(ARCHIVE.map(a=>a.tag))];
  let active = 'All';

  const $f = document.getElementById('filters');
  const $g = document.getElementById('agrid');

  function draw(){
    $g.innerHTML = '';
    ARCHIVE.filter(a=>active==='All' ? true : a.tag===active).forEach(a=>{
      const item = document.createElement('div');
      item.className = 'aItem';
      item.innerHTML = `
        <div class="aThumb">${svgPhoto(a.tag + ' · ' + a.title)}</div>
        <div class="aBody">
          <div class="aTag">${escapeHtml(a.tag)}</div>
          <div class="aTitle">${escapeHtml(a.title)}</div>
          <div class="aMeta">${escapeHtml(a.meta)}</div>
        </div>
      `;
      $g.appendChild(item);
    });
  }

  tags.forEach(t=>{
    const b = document.createElement('button');
    b.className = 'chip' + (t===active ? ' active':'');
    b.textContent = t;
    b.addEventListener('click', ()=>{
      active = t;
      document.querySelectorAll('.chip').forEach(x=>x.classList.toggle('active', x.textContent===active));
      draw();
    });
    $f.appendChild(b);
  });

  draw();
}

function viewNowThen(){
  const el = document.createElement('section');
  el.className = 'card pad';
  el.innerHTML = `
    <h2 class="h2">Now &amp; Then</h2>
    <p class="p">Drag the slider to compare. Replace placeholders with the same viewpoint for best effect.</p>

    <div class="compareWrap">
      <div class="compare" id="compare">
        <div class="base">${svgPhoto('THEN · historical viewpoint (placeholder)')}</div>
        <div class="top" id="topLayer">${svgPhoto('NOW · current viewpoint (placeholder)')}</div>
      </div>
      <input class="slider" id="slider" type="range" min="0" max="100" value="50" />
      <div class="small">
        Tip: use two images from nearly the same axis (e.g., a tree-lined promenade) to make change readable.
      </div>
    </div>
  `;
  $main.appendChild(el);

  const top = document.getElementById('topLayer');
  const slider = document.getElementById('slider');
  const update = ()=>{
    const v = Number(slider.value);
    top.style.clipPath = `inset(0 ${100 - v}% 0 0)`;
  };
  slider.addEventListener('input', update);
  update();
}

function viewWhatDefines(){
  const el = document.createElement('section');
  el.className = 'card pad';

  el.innerHTML = `
    <h2 class="h2">Intro: What is “Heritage”?</h2>

    <div style="margin-top:12px;">
      <div class="imgWrap">
        <div id="p1Skeleton" class="imgSkeleton">Loading image…</div>
        <img id="p1Img" class="pageImg" alt="Intro image (p1)" />
      </div>
    </div>

    <h3 class="h2" style="margin-top:14px;">
      Why it is a "<span class="red">heritage</span>" rather than just a "<span class="red">remain</span>"?
    </h3>

    <p class="p">
      Heritage is not simply what is left behind — it is what still <b>matters</b>.
      It carries links of memory: connections between people, events, and places that allow the past
      to remain present in everyday life.
      <br/><br/>
      More importantly, heritage generates cultural resonance. It can trigger recognition, empathy,
      and reflection across generations. In this sense, heritage holds value — historical, civic, and emotional:
      it helps communities remember, interpret, and re-imagine their identity through space.
    </p>

    <div style="height:18px;"></div>

    <h3 class="h2">
      What defines a city — buildings, or the way people come together when everything burns?
    </h3>

    <div class="actions" style="margin-top:16px;">
      <a class="btn" href="#/" data-link>Back to Home</a>
    </div>
  `;
  $main.appendChild(el);

  // safe image load
  const img = document.getElementById('p1Img');
  const sk  = document.getElementById('p1Skeleton');
  const SRC = 'p1.jpg';
  const pre = new Image();
  pre.onload = () => { img.src = SRC; sk.classList.add('hide'); };
  pre.onerror = () => { sk.textContent = 'Image failed to load (check file path/name).'; };
  pre.src = SRC + '?v=' + Date.now();
}

function viewAbout(){
  const el = document.createElement('section');
  el.className = 'card pad';
  el.innerHTML = `
    <h2 class="h2">About</h2>
    <p class="p">
      This prototype explores Lincoln Park as a special site of landscape rebirth across the Great Chicago Fire.
      It combines archival research, narrative scripting, and web interaction to let visitors “walk through time”.
    </p>

    <div class="scene" style="margin-top:14px;">
      <div class="sceneHeader">
        <div>
          <h3 class="sceneTitle" style="font-size:18px; margin:0;">Method</h3>
          <div class="sceneMeta">Digital heritage · Narrative timeline · Archival interpretation</div>
        </div>
      </div>
      <div class="p" style="margin:0;">
        Replace placeholders with verified sources. Add citations per archive item (repository, year, call number, URL).
      </div>
    </div>

    <div class="scene">
      <div class="sceneHeader">
        <div>
          <h3 class="sceneTitle" style="font-size:18px; margin:0;">Contact (placeholder)</h3>
          <div class="sceneMeta">Politecnico di Torino</div>
        </div>
      </div>
      <div class="p" style="margin:0;">Email: your-group-email@polito.it</div>
    </div>

    <div class="actions" style="margin-top:16px;">
      <a class="btn" href="#/" data-link>Back to Home</a>
    </div>
  `;
  $main.appendChild(el);
}

function viewNotFound(){
  const el = document.createElement('section');
  el.className = 'card pad';
  el.innerHTML = `
    <h2 class="h2">Not found</h2>
    <p class="p">This page doesn’t exist yet.</p>
    <div class="actions"><a class="btn primary" href="#/" data-link>Back home</a></div>
  `;
  $main.appendChild(el);
}

/* =========================
   Timeline render helpers
   ========================= */
function formatNarration(scene, narration){
  let safe = escapeHtml(narration || '');
  safe = safe.replace(/\n/g, '<br>');
  if(scene.id === 'intro'){
    safe = safe.replace(/citizen/i, '<span class="red">citizen</span>');
  }
  return safe;
}

function renderPerspectiveToggle(scene){
  if(scene.id !== 'intro') return '';
  const p = getIntroPerspective();
  const next = (p === 'architect') ? 'citizen' : 'architect';
  const tag = (p === 'architect') ? 'Perspective: Architect / Planner' : 'Perspective: Citizen';
  return `
    <div class="perspBar">
      <div class="perspTag">${escapeHtml(tag)}</div>
      <button class="perspBtn" data-persp="${escapeHtml(next)}">Switch perspective (Try it) →</button>
    </div>
  `;
}

function renderIntroLines(scene, lines){
  if(scene.id !== 'intro' || !lines) return '';
  return `
    <div class="introLines">
      ${lines.map((line, i)=>`
        <p class="introLine" style="--d:${i}">${escapeHtml(line)}</p>
      `).join('')}
    </div>
  `;
}

function renderIntroQuiz(scene){
  if(scene.id !== 'intro' || !scene.quiz) return '';
  return `
    <div class="quizBox">
      <div class="quizQ">${escapeHtml(scene.quiz.question)}</div>
      <div class="choice">
        ${scene.quiz.options.map(o=>`
          <button data-quiz="${escapeHtml(scene.id)}" data-quiz-choice="${escapeHtml(o.key)}">${escapeHtml(o.label)}</button>
        `).join('')}
      </div>
      <div class="quizReveal" id="quizReveal-${escapeHtml(scene.id)}"></div>
    </div>
  `;
}

function renderInteractive(interactive, sceneId){
  if(!interactive || interactive.type==='none') return '';
  if(interactive.type==='choice'){
    return `
      <div class="scene" style="margin-top:12px; background:rgba(0,0,0,.14);">
        <div class="sideTitle" style="margin:0 0 10px;">Micro-interaction</div>
        <div class="p" style="margin:0 0 10px; font-size:13px;">${escapeHtml(interactive.prompt)}</div>
        <div class="choice">
          ${interactive.options.map(o=>`
            <button data-scene="${escapeHtml(sceneId)}" data-choice="${escapeHtml(o.key)}">${escapeHtml(o.label)}</button>
          `).join('')}
        </div>
        <div class="reveal" id="reveal-${escapeHtml(sceneId)}"></div>
      </div>
    `;
  }
  if(interactive.type==='link'){
    return `<div class="actions" style="margin-top:12px;">
      <a class="btn primary" href="${interactive.to}">${escapeHtml(interactive.label)} →</a>
    </div>`;
  }
  return '';
}

function renderSceneBody(scene){
  if(scene.id === 'intro'){
    return `<div style="margin-top:12px;">${svgPhoto(getIntroPerspective()==='architect' ? 'Intro · plans (placeholder)' : 'Intro · tent city (placeholder)')}</div>`;
  }
  if(scene.id === '1865-1871'){
    return renderAct1Vertical();
  }
  if(scene.id === '1871'){
    return renderFire1871P1();
  }
  if(scene.id === '1871-1900'){
    return renderS3_1871_1900();
  }
  return `<div style="margin-top:12px;">${svgPhoto(scene.title + ' · media placeholder')}</div>`;
}

/* =========================
   Act I vertical
   ========================= */
function renderAct1Vertical(){
  return `
    <div class="vStack">
      <div class="vStackInner">
        ${ACT1_IMAGES.map((it, idx)=>`
          <div class="vShot" data-fullsrc="${escapeHtml(it.src)}" data-fulltitle="${escapeHtml(it.title)}">
            <img class="pageImg" src="${escapeHtml(it.src)}" alt="${escapeHtml(it.title)}" loading="eager" decoding="async"/>
          </div>
          <div class="vCaption">
            <div class="vCapTitle">${escapeHtml(it.title)}</div>
            <p class="vCapText">${escapeHtml(it.text)}</p>
          </div>
        `).join('')}
      </div>
    </div>
  `;
}

/* =========================
   1871 Fire Page (clean, single layout)
   ========================= */
function renderFire1871P1(){
  const d = FIRE_1871_P1;
  return `
    <div class="fireP1">
      <div class="fireGlow"></div>

      <div class="fireInner">

        <div class="fireLeft">
          <div class="fireP1Grid">

            <div class="fireBlock">
              <div class="fireLabel">${escapeHtml(d.a1_title)}</div>
              <h4 class="fireTitle">${escapeHtml(d.title)}</h4>
              <p class="fireText">${escapeHtml(d.a1_text)}</p>
            </div>

            <div class="fireBlock">
              <div class="fireLabel">${escapeHtml(d.a2_title)}</div>
              <p class="fireText fireNarrative" id="fireNarrative">${escapeHtml(d.a2_text)}</p>
            </div>

          </div>

          <div class="fireBlock">
            <div class="fireLabel">${escapeHtml(d.a3_title)}</div>
            <div class="seasonRow">
              ${d.seasons.map(s=>`
                <div class="seasonCard" data-src="${escapeHtml(s.src)}">
                  <div class="seasonName">${escapeHtml(s.label)}</div>
                  <div class="seasonHint">${escapeHtml(s.hint)}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>

        <div class="fireRight">
          <div class="fireMain">
            <img id="fireMainImg" alt="Couch Tomb" />
          </div>
        </div>

      </div>
    </div>
  `;
}

function fireP1Autostart(){
  const img = document.getElementById('fireMainImg');
  if(!img) return;
  const first = FIRE_1871_P1?.seasons?.[0]?.src;
  if(first) img.src = first;

  const nar = document.getElementById('fireNarrative');
  if(nar){
    nar.classList.remove('show');
    setTimeout(()=> nar.classList.add('show'), 80);
  }
}

/* =========================
   1871–1900 S3 render
   ========================= */
function renderS3_1871_1900(){
  const intro = S3_1871_1900.intro;

  const introMarkers = intro.markers.map(m=>`
    <div class="s3Marker" style="left:${m.x}%; top:${m.y}%;" data-s3-speech="${escapeHtml(m.speech)}">
      <span>+</span>
    </div>
  `).join('');

  const actsHtml = S3_1871_1900.acts.map(a=>{
    const mk = a.marker ? `
      <div class="s3Marker" style="left:${a.marker.x}%; top:${a.marker.y}%;" data-s3-target="s3Reveal-${escapeHtml(a.id)}" data-s3-speech="${escapeHtml(a.marker.speech)}">
        <span>+</span>
      </div>
    ` : '';

    const rev = a.marker ? `<div class="s3Reveal" id="s3Reveal-${escapeHtml(a.id)}"></div>` : '';

    return `
      <div class="s3Card" id="s3-${escapeHtml(a.id)}">
        <div class="s3Stage" style="--s3bg:url('${escapeHtml(a.bg)}')">
          <div class="s3StageInner">${mk}</div>
        </div>
        <div class="s3Pad">
          <div class="s3Title">${escapeHtml(a.title)}</div>
          <p class="s3Text">${escapeHtml(a.narration)}</p>
          ${a.marker ? `<div class="s3Hint">Click the icon to reveal a note.</div>` : ``}
          ${rev}
        </div>
      </div>
    `;
  }).join('');

  return `
    <div class="s3Wrap">
      <div class="s3Card" id="s3-intro">
        <div class="s3Stage" style="--s3bg:url('${escapeHtml(intro.bg)}')">
          <div class="s3StageInner">${introMarkers}</div>
        </div>
        <div class="s3Pad">
          <div class="s3Title">${escapeHtml(intro.title)}</div>
          <p class="s3Text">${escapeHtml(intro.narration)}</p>
          <div class="s3Hint">${escapeHtml(intro.hint)}</div>
          <div class="s3Reveal" id="s3Reveal-intro"></div>
        </div>
      </div>
      ${actsHtml}
    </div>
  `;
}

/* =========================
   Global interactions
   ========================= */

// ① Choice reveal (scene micro-interaction)
document.addEventListener('click', (e)=>{
  const btn = e.target.closest('button[data-choice]');
  if(!btn) return;
  const sceneId = btn.dataset.scene;
  const key = btn.dataset.choice;
  const scene = SCENES.find(s=>s.id===sceneId);
  if(!scene || scene.interactive.type!=='choice') return;
  const found = scene.interactive.options.find(o=>o.key===key);
  const box = document.getElementById('reveal-' + sceneId);
  if(!found || !box) return;
  box.style.display = 'block';
  box.textContent = found.reveal;
});

// ② Perspective toggle
document.addEventListener('click', (e)=>{
  const b = e.target.closest('button[data-persp]');
  if(!b) return;
  const next = b.dataset.persp;
  if(!next) return;
  setIntroPerspective(next);
  render();
});

// ③ Intro quiz reveal
document.addEventListener('click', (e)=>{
  const b = e.target.closest('button[data-quiz-choice]');
  if(!b) return;
  const sceneId = b.dataset.quiz;
  const key = b.dataset.quizChoice;
  const scene = SCENES.find(s=>s.id === sceneId);
  if(!scene || !scene.quiz) return;
  const found = scene.quiz.options.find(o=>o.key === key);
  const box = document.getElementById('quizReveal-' + sceneId);
  if(!found || !box) return;
  box.style.display = 'block';
  box.textContent = found.reveal;
});

// ④ 1871 seasonal cards -> swap main image
document.addEventListener('click', (e)=>{
  const card = e.target.closest('.seasonCard');
  if(!card) return;
  const img = document.getElementById('fireMainImg');
  if(!img) return;

  const nextSrc = card.dataset.src;
  if(!nextSrc) return;

  img.style.opacity = '0';
  setTimeout(()=>{
    img.src = nextSrc;
    const pre = new Image();
    pre.onload = ()=>{ img.style.opacity = '1'; };
    pre.onerror = ()=>{ img.style.opacity = '1'; };
    pre.src = nextSrc;
  }, 120);
});

// ⑤ Act I image fullscreen modal
document.addEventListener('click', (e)=>{
  const shot = e.target.closest('.vShot');
  if(!shot) return;
  const src = shot.dataset.fullsrc;
  const title = shot.dataset.fulltitle || '';
  if(src) openImgModal(src, title);
});

// ⑥ S3 marker reveal (1871–1900)
document.addEventListener('click', (e)=>{
  const m = e.target.closest('.s3Marker');
  if(!m) return;

  const speech = m.getAttribute('data-s3-speech') || '';
  const targetId = m.getAttribute('data-s3-target'); // optional
  const box = targetId ? document.getElementById(targetId) : document.getElementById('s3Reveal-intro');

  if(!box) return;
  box.textContent = speech.replaceAll('&#039;',"'"); // minor readability (safe enough for plain text)
  box.classList.add('show');
  box.style.display = 'block';
});

/* =========================
   Utilities
   ========================= */
function scrollToScene(id){
  const el = document.getElementById('scene-' + id);
  if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
}

/* Initial render */
render();
</script>
</body>
</html>
